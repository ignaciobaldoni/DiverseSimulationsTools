; Edited by I Baldoni based on data provided by iXBlue for this fiber

tau_Er:=10 ms  { upper-state lifetime }

l1_980_Er:=916
l2_980_Er:=1038
dl_980_Er:=2
defarray abs_Er5_980[l1_980_Er,l2_980_Er,dl_980_Er]
defarray em_Er5_980[l1_980_Er,l2_980_Er,dl_980_Er]

l1_1500_Er:=1450
l2_1500_Er:=1600
dl_1500_Er:=0.5
defarray abs_Er5_1500[l1_1500_Er,l2_1500_Er,dl_1500_Er]
defarray em_Er5_1500[l1_1500_Er,l2_1500_Er,dl_1500_Er]

ld1 := 912
ld2 := 1650
dld := 1 
defarray D_f[ld1,ld2,dld]

(*
;0.8043 is because the actual fiber in house has a absorption of
;4.7 dB/m @ 1530 and this specsheet is for the same fiber but with
;6 dB/m 
*)

abs_5Er(l):=
  { erbium absorption in dB/m }
  if l1_980_Er <= l/nm <= l2_980_Er
  then 0.8034*abs_Er5_980~[l/nm]
  else if l1_1500_Er <= l/nm <= l2_1500_Er
  then abs_Er5_1500~[l/nm]
  else 0
em_5Er(l):=
  { erbium emission in dB/m (for 100% Er excitation) }
  if l1_1500_Er <= l/nm <= l2_1500_Er
  then 0.8034*em_Er5_1500~[l/nm]
  else 0

; Data: l in nm, abs_Er in dB/m, em_Er in dB/m

readlist l, abs_Er5_1500[l], em_Er5_1500[l]:
1450	0.951288901	0.159134911
1450.5	0.975527034	0.165159816
1451	0.999765167	0.17130559
1451.5	1.0240033	0.177574155
1452	1.05208504	0.184642014
1452.5	1.080166779	0.191852828
1453	1.108248518	0.199208872
1453.5	1.136330257	0.206712454
1454	1.166200082	0.214695098
1454.5	1.196069907	0.222837894
1455	1.225939732	0.231143382
1455.5	1.255809557	0.239614133
1456	1.28599169	0.248313057
1456.5	1.316173822	0.257183939
1457	1.346355954	0.266229479
1457.5	1.376538086	0.275452417
1458	1.408851521	0.285287111
1458.5	1.441164957	0.2953151
1459	1.473478391	0.305539409
1459.5	1.505791827	0.315963104
1460	1.535657342	0.326069521
1460.5	1.565522858	0.336369203
1461	1.595388373	0.346865133
1461.5	1.625253889	0.357560334
1462	1.658415867	0.369191719
1462.5	1.691577846	0.381045971
1463	1.724739825	0.39312653
1463.5	1.757901804	0.405436879
1464	1.790677623	0.41789043
1464.5	1.823453443	0.430578744
1465	1.856229263	0.44350541
1465.5	1.889005082	0.456674063
1466	1.920399437	0.469750469
1466.5	1.951793791	0.4830683
1467	1.983188146	0.496631205
1467.5	2.014582501	0.510442882
1468	2.047042828	0.52478035
1468.5	2.079503154	0.539380568
1469	2.111963482	0.554247489
1469.5	2.144423808	0.569385116
1470	2.172917886	0.583732012
1470.5	2.201411964	0.598332751
1471	2.229906043	0.613191079
1471.5	2.25840012	0.628310791
1472	2.287926757	0.643986371
1472.5	2.317453394	0.659937885
1473	2.34698003	0.67616939
1473.5	2.376506667	0.692684995
1474	2.401741664	0.708223349
1474.5	2.426976661	0.724024618
1475	2.452211658	0.740092583
1475.5	2.477446655	0.756431075
1476	2.503391234	0.773263154
1476.5	2.529335813	0.790378675
1477	2.555280392	0.807781701
1477.5	2.58122497	0.825476344
1478	2.603656898	0.842330364
1478.5	2.626088825	0.85945798
1479	2.648520752	0.876863032
1479.5	2.670952679	0.894549405
1480	2.69073191	0.911622297
1480.5	2.710511141	0.928963603
1481	2.730290373	0.946577015
1481.5	2.750069604	0.964466272
1482	2.767070041	0.981649348
1482.5	2.78407048	0.999093101
1483	2.801070917	1.016801037
1483.5	2.818071355	1.034776705
1484	2.834068147	1.052650913
1484.5	2.850064938	1.070791487
1485	2.866061729	1.089201966
1485.5	2.882058521	1.107885931
1486	2.8943691	1.1254137
1486.5	2.906679679	1.143189303
1487	2.918990258	1.161215916
1487.5	2.931300837	1.179496755
1488	2.938689133	1.196031725
1488.5	2.946077428	1.212781539
1489	2.953465724	1.229748782
1489.5	2.960854019	1.246936069
1490	2.970646374	1.26537007
1490.5	2.980438729	1.284052842
1491	2.990231084	1.302987463
1491.5	3.000023438	1.32217705
1492	3.007326378	1.340515095
1492.5	3.014629318	1.35908914
1493	3.021932258	1.377902002
1493.5	3.029235197	1.396956525
1494	3.031447541	1.41388131
1494.5	3.033659885	1.430999556
1495	3.035872229	1.448313339
1495.5	3.038084573	1.465824754
1496	3.04199666	1.484365322
1496.5	3.045908746	1.503126587
1497	3.049820833	1.522111009
1497.5	3.05373292	1.541321073
1498	3.061424713	1.562688625
1498.5	3.069116505	1.584330504
1499	3.076808297	1.60624997
1499.5	3.08450009	1.628450317
1500	3.089420253	1.649455093
1500.5	3.094340416	1.670714074
1501	3.099260579	1.692230133
1501.5	3.104180742	1.714006173
1502	3.107970003	1.735413665
1502.5	3.111759264	1.757072833
1503	3.115548526	1.778986451
1503.5	3.119337788	1.801157318
1504	3.130257968	1.827751992
1504.5	3.141178148	1.854703016
1505	3.152098328	1.882014754
1505.5	3.163018508	1.909691618
1506	3.179405416	1.941075593
1506.5	3.195792325	1.972908347
1507	3.212179234	2.005195621
1507.5	3.228566143	2.037943221
1508	3.251555685	2.075371285
1508.5	3.274545227	2.113365536
1509	3.297534768	2.151933462
1509.5	3.32052431	2.191082639
1510	3.351047023	2.235846931
1510.5	3.381569735	2.281319765
1511	3.412092447	2.327510743
1511.5	3.44261516	2.374429582
1512	3.47783575	2.42536231
1512.5	3.513056341	2.477115409
1513	3.548276932	2.529700086
1513.5	3.583497523	2.583127685
1514	3.630244658	2.645810508
1514.5	3.676991791	2.709545332
1515	3.723738925	2.774346812
1515.5	3.770486059	2.840229784
1516	3.838641359	2.923513748
1516.5	3.906796658	3.008269418
1517	3.974951957	3.094517777
1517.5	4.043107257	3.182280065
1518	4.135333296	3.290732311
1518.5	4.227559336	3.401163562
1519	4.319785376	3.513602396
1519.5	4.412011416	3.62807774
1520	4.530947163	3.766824123
1520.5	4.649882911	3.908153654
1521	4.768818659	4.052103892
1521.5	4.887754406	4.198712862
1522	5.018476887	4.358255155
1522.5	5.149199368	4.520757878
1523	5.279921849	4.686263947
1523.5	5.410644329	4.854816809
1524	5.509073117	4.997167501
1524.5	5.621324265	5.154688459
1525	5.711342268	5.294406612
1525.5	5.804359483	5.439332874
1526	5.86857302	5.559464893
1526.5	5.932786557	5.681529465
1527	5.977195439	5.786380314
1527.5	6	5.87165689
1528	6	5.91
1528.5	5.991718344	5.940697674
1529	5.961532307	5.961532307
1529.5	5.915983197	5.980226283
1530	5.85225079	5.980000694
1530.5	5.75755151	5.94703774
1531	5.660332067	5.909983517
1531.5	5.545109022	5.852385009
1532	5.478651283	5.813157444
1532.5	5.412193543	5.773929879
1533	5.252367414	5.664030987
1533.5	5.092541285	5.551040152
1534	4.932715156	5.434906672
1534.5	4.772889027	5.315579175
1535	4.625558073	5.207071661
1535.5	4.478227118	5.095568669
1536	4.330896164	4.981021403
1536.5	4.18356521	4.863380427
1537	4.084749174	4.799600941
1537.5	3.936525121	4.697960163
1538	3.788301068	4.596319384
1538.5	3.736910009	4.582624887
1539	3.685518949	4.5680754
1539.5	3.634127889	4.552655177
1540	3.582736829	4.536348264
1540.5	3.540254923	4.530539715
1541	3.497773016	4.52405582
1541.5	3.455291109	4.516883634
1542	3.412809202	4.509010032
1542.5	3.37081546	4.50107356
1543	3.328821719	4.492422791
1543.5	3.286827976	4.48304426
1544	3.244834234	4.472924317
1544.5	3.198022204	4.455336513
1545	3.151210175	4.436836577
1545.5	3.104398145	4.417408155
1546	3.057586115	4.397034672
1546.5	3.010271147	4.374968388
1547	2.96295618	4.351907709
1547.5	2.915641213	4.327835154
1548	2.868326245	4.30273301
1548.5	2.824606016	4.282032863
1549	2.780885787	4.26038237
1549.5	2.737165557	4.237764824
1550	2.693445327	4.214163294
1550.5	2.658075366	4.202763486
1551	2.622705404	4.190623967
1551.5	2.587335443	4.177731267
1552	2.551965481	4.164071736
1552.5	2.521729846	4.158097565
1553	2.491494211	4.151507027
1553.5	2.461258575	4.144288558
1554	2.43102294	4.136430437
1554.5	2.397682742	4.12258279
1555	2.394578179	4.113918486
1555.5	2.379460361	4.110938957
1556	2.364342543	4.107959429
1556.5	2.331002345	4.092546495
1557	2.297662146	4.076329944
1557.5	2.263385246	4.057616303
1558	2.229108345	4.038035209
1558.5	2.194831445	4.017571535
1559	2.160554544	3.996209955
1559.5	2.121974642	3.965892786
1560	2.083394739	3.934478369
1560.5	2.044814837	3.901948299
1561	2.006234934	3.868283929
1561.5	1.959501007	3.817580367
1562	1.91276708	3.765373329
1562.5	1.866033153	3.711638584
1563	1.819299227	3.656351595
1563.5	1.773800581	3.601995957
1564	1.728301934	3.54609022
1564.5	1.682803288	3.488609672
1565	1.637304641	3.429529282
1565.5	1.591341119	3.367839867
1566	1.545377597	3.304479201
1566.5	1.499414076	3.239421004
1567	1.453450554	3.172638666
1567.5	1.410086109	3.10983731
1568	1.366721664	3.045376165
1568.5	1.323357219	2.97922934
1569	1.279992774	2.91137062
1569.5	1.238778504	2.846714567
1570	1.197564234	2.780395157
1570.5	1.156349964	2.712386667
1571	1.115135694	2.642663053
1571.5	1.079497742	2.584548851
1572	1.04385979	2.524941237
1572.5	1.00822184	2.463817168
1573	0.972583888	2.401153314
1573.5	0.941855672	2.349171901
1574	0.911127456	2.295854561
1574.5	0.88039924	2.241180723
1575	0.849671025	2.185129559
1575.5	0.822015914	2.135664165
1576	0.794360803	2.084942502
1576.5	0.766705693	2.032945319
1577	0.739050582	1.979653132
1577.5	0.716514594	1.938898635
1578	0.693978606	1.897092351
1578.5	0.671442619	1.854218133
1579	0.648906631	1.810259632
1579.5	0.632347352	1.782043505
1580	0.615788073	1.753052913
1580.5	0.599228793	1.723275816
1581	0.582669515	1.692700022
1581.5	0.568866368	1.669401368
1582	0.555063222	1.645443532
1582.5	0.541260075	1.620816215
1583	0.527456929	1.595508992
1583.5	0.515953206	1.576537388
1584	0.504449484	1.557007044
1584.5	0.492945761	1.536909175
1585	0.481442039	1.516234886
1585.5	0.470998426	1.498347609
1586	0.460554813	1.479933972
1586.5	0.4501112	1.460985716
1587	0.439667587	1.441494481
1587.5	0.431734814	1.429766901
1588	0.423802042	1.417646988
1588.5	0.415869269	1.405128447
1589	0.407936496	1.392204904
1589.5	0.399123564	1.375835872
1590	0.390310633	1.358987826
1590.5	0.381497701	1.341653289
1591	0.37268477	1.323824694
1591.5	0.366903216	1.316370316
1592	0.361121661	1.308624677
1592.5	0.355340107	1.300583004
1593	0.349558552	1.292240465
1593.5	0.34204356	1.277119868
1594	0.334528568	1.261559033
1594.5	0.327013575	1.245551124
1595	0.319498582	1.229089223
1595.5	0.314152298	1.220592524
1596	0.308806012	1.211795952
1596.5	0.303459728	1.202694693
1597	0.298113443	1.193283872
1597.5	0.290754999	1.175424077
1598	0.283396554	1.157082817
1598.5	0.27603811	1.138252773
1599	0.268679667	1.118926535
1599.5	0.265609702	1.117133617
1600	0.262539737	1.115187675


readlist l, abs_Er5_980[l], em_Er5_980[l]:
916	0.008174486	0
918	0.033835523	0
920	0.064153613	0
922	0.10189416	0
924	0.023035935	0
926	0.02978125	0
928	0.049105974	0
930	0.006724598	0
932	0.038469312	0
934	0.071525037	0
936	0.077498375	0
938	0.068151761	0
940	0.06662066	0
942	0.078811464	0
944	0.109935763	0
946	0.12302767	0
948	0.1631011	0
950	0.205308854	0
952	0.273623051	0
954	0.451949642	0
956	0.636154561	0
958	0.848437976	0
960	1.175263756	0
962	1.529580066	0
964	1.858585593	0
966	2.243660201	0
968	2.54492626	0
970	2.865506453	0
972	3.167998659	0
974	3.519171871	0
976	3.887521246	0
978	3.9	0
980	3.59566578	0
982	3.129101924	0
984	2.625514436	0
986	2.164741667	0
988	1.775050995	0
990	1.486714012	0
992	1.280439733	0
994	1.134561567	0
996	0.942602772	0
998	0.857933186	0
1000	0.73759206	0
1002	0.613398955	0
1004	0.535852579	0
1006	0.423958624	0
1008	0.363932521	0
1010	0.283651147	0
1012	0.247300958	0
1014	0.17957326	0
1016	0.122162234	0
1018	0.093116728	0
1020	0.088769261	0
1022	0.070865388	0
1024	0.05029787	0
1026	0.026717389	0
1028	0.033181049	0
1030	0.003492598	0
1032	0.034853737	0
1034	0.0135857	0
1036	0.008096895	0
1038	0.001250205	0


readlist l, D_f[l]:
1150.000000, -30.728767
1151.000000, -30.619937
1152.000000, -30.511669
1153.000000, -30.403960
1154.000000, -30.296806
1155.000000, -30.190206
1156.000000, -30.084155
1157.000000, -29.978650
1158.000000, -29.873689
1159.000000, -29.769268
1160.000000, -29.665384
1161.000000, -29.562035
1162.000000, -29.459216
1163.000000, -29.356926
1164.000000, -29.255161
1165.000000, -29.153918
1166.000000, -29.053198
1167.000000, -28.952994
1168.000000, -28.853304
1169.000000, -28.754123
1170.000000, -28.655449
1171.000000, -28.557279
1172.000000, -28.459610
1173.000000, -28.362440
1174.000000, -28.265765
1175.000000, -28.169582
1176.000000, -28.073889
1177.000000, -27.978682
1178.000000, -27.883959
1179.000000, -27.789717
1180.000000, -27.695953
1181.000000, -27.602663
1182.000000, -27.509847
1183.000000, -27.417499
1184.000000, -27.325618
1185.000000, -27.234201
1186.000000, -27.143245
1187.000000, -27.052747
1188.000000, -26.962704
1189.000000, -26.873114
1190.000000, -26.783974
1191.000000, -26.695281
1192.000000, -26.607032
1193.000000, -26.519225
1194.000000, -26.431857
1195.000000, -26.344928
1196.000000, -26.258433
1197.000000, -26.172369
1198.000000, -26.086733
1199.000000, -26.001522
1200.000000, -25.916734
1201.000000, -25.832366
1202.000000, -25.748415
1203.000000, -25.664880
1204.000000, -25.581756
1205.000000, -25.499042
1206.000000, -25.416735
1207.000000, -25.334832
1208.000000, -25.253332
1209.000000, -25.172230
1210.000000, -25.091525
1211.000000, -25.011214
1212.000000, -24.931295
1213.000000, -24.851765
1214.000000, -24.772621
1215.000000, -24.693862
1216.000000, -24.615484
1217.000000, -24.537484
1218.000000, -24.459862
1219.000000, -24.382614
1220.000000, -24.305737
1221.000000, -24.229229
1222.000000, -24.153088
1223.000000, -24.077312
1224.000000, -24.001899
1225.000000, -23.926846
1226.000000, -23.852151
1227.000000, -23.777810
1228.000000, -23.703822
1229.000000, -23.630184
1230.000000, -23.556893
1231.000000, -23.483947
1232.000000, -23.411345
1233.000000, -23.339082
1234.000000, -23.267158
1235.000000, -23.195570
1236.000000, -23.124316
1237.000000, -23.053393
1238.000000, -22.982799
1239.000000, -22.912532
1240.000000, -22.842589
1241.000000, -22.772968
1242.000000, -22.703668
1243.000000, -22.634686
1244.000000, -22.566019
1245.000000, -22.497665
1246.000000, -22.429623
1247.000000, -22.361890
1248.000000, -22.294464
1249.000000, -22.227342
1250.000000, -22.160523
1251.000000, -22.094004
1252.000000, -22.027784
1253.000000, -21.961860
1254.000000, -21.896232
1255.000000, -21.830897
1256.000000, -21.765850
1257.000000, -21.701092
1258.000000, -21.636619
1259.000000, -21.572430
1260.000000, -21.508522
1261.000000, -21.444894
1262.000000, -21.381544
1263.000000, -21.318468
1264.000000, -21.255667
1265.000000, -21.193136
1266.000000, -21.130875
1267.000000, -21.068882
1268.000000, -21.007154
1269.000000, -20.945689
1270.000000, -20.884486
1271.000000, -20.823543
1272.000000, -20.762857
1273.000000, -20.702427
1274.000000, -20.642251
1275.000000, -20.582327
1276.000000, -20.522653
1277.000000, -20.463228
1278.000000, -20.404048
1279.000000, -20.345113
1280.000000, -20.286421
1281.000000, -20.227969
1282.000000, -20.169757
1283.000000, -20.111783
1284.000000, -20.054045
1285.000000, -19.996540
1286.000000, -19.939267
1287.000000, -19.882224
1288.000000, -19.825409
1289.000000, -19.768821
1290.000000, -19.712457
1291.000000, -19.656316
1292.000000, -19.600396
1293.000000, -19.544696
1294.000000, -19.489213
1295.000000, -19.433947
1296.000000, -19.378895
1297.000000, -19.324056
1298.000000, -19.269427
1299.000000, -19.215008
1300.000000, -19.160797
1301.000000, -19.106792
1302.000000, -19.052992
1303.000000, -18.999394
1304.000000, -18.945998
1305.000000, -18.892801
1306.000000, -18.839802
1307.000000, -18.787000
1308.000000, -18.734393
1309.000000, -18.681979
1310.000000, -18.629757
1311.000000, -18.577725
1312.000000, -18.525883
1313.000000, -18.474229
1314.000000, -18.422761
1315.000000, -18.371477
1316.000000, -18.320375
1317.000000, -18.269455
1318.000000, -18.218715
1319.000000, -18.168153
1320.000000, -18.117768
1321.000000, -18.067559
1322.000000, -18.017523
1323.000000, -17.967661
1324.000000, -17.917969
1325.000000, -17.868448
1326.000000, -17.819095
1327.000000, -17.769909
1328.000000, -17.720889
1329.000000, -17.672033
1330.000000, -17.623340
1331.000000, -17.574809
1332.000000, -17.526439
1333.000000, -17.478227
1334.000000, -17.430174
1335.000000, -17.382277
1336.000000, -17.334535
1337.000000, -17.286947
1338.000000, -17.239512
1339.000000, -17.192228
1340.000000, -17.145095
1341.000000, -17.098110
1342.000000, -17.051275
1343.000000, -17.004586
1344.000000, -16.958042
1345.000000, -16.911643
1346.000000, -16.865386
1347.000000, -16.819271
1348.000000, -16.773297
1349.000000, -16.727463
1350.000000, -16.681766
1351.000000, -16.636207
1352.000000, -16.590785
1353.000000, -16.545497
1354.000000, -16.500343
1355.000000, -16.455322
1356.000000, -16.410432
1357.000000, -16.365674
1358.000000, -16.321044
1359.000000, -16.276544
1360.000000, -16.232171
1361.000000, -16.187925
1362.000000, -16.143804
1363.000000, -16.099807
1364.000000, -16.055934
1365.000000, -16.012184
1366.000000, -15.968555
1367.000000, -15.925047
1368.000000, -15.881658
1369.000000, -15.838388
1370.000000, -15.795236
1371.000000, -15.752201
1372.000000, -15.709283
1373.000000, -15.666479
1374.000000, -15.623790
1375.000000, -15.581213
1376.000000, -15.538749
1377.000000, -15.496397
1378.000000, -15.454155
1379.000000, -15.412023
1380.000000, -15.370000
1381.000000, -15.328084
1382.000000, -15.286277
1383.000000, -15.244575
1384.000000, -15.202980
1385.000000, -15.161489
1386.000000, -15.120103
1387.000000, -15.078820
1388.000000, -15.037639
1389.000000, -14.996561
1390.000000, -14.955583
1391.000000, -14.914706
1392.000000, -14.873929
1393.000000, -14.833251
1394.000000, -14.792671
1395.000000, -14.752189
1396.000000, -14.711804
1397.000000, -14.671515
1398.000000, -14.631322
1399.000000, -14.591224
1400.000000, -14.551221
1401.000000, -14.511312
1402.000000, -14.471496
1403.000000, -14.431773
1404.000000, -14.392141
1405.000000, -14.352601
1406.000000, -14.313152
1407.000000, -14.273793
1408.000000, -14.234524
1409.000000, -14.195344
1410.000000, -14.156253
1411.000000, -14.117250
1412.000000, -14.078335
1413.000000, -14.039507
1414.000000, -14.000765
1415.000000, -13.962109
1416.000000, -13.923540
1417.000000, -13.885055
1418.000000, -13.846656
1419.000000, -13.808340
1420.000000, -13.770109
1421.000000, -13.731961
1422.000000, -13.693896
1423.000000, -13.655914
1424.000000, -13.618015
1425.000000, -13.580197
1426.000000, -13.542461
1427.000000, -13.504806
1428.000000, -13.467232
1429.000000, -13.429739
1430.000000, -13.392327
1431.000000, -13.354994
1432.000000, -13.317741
1433.000000, -13.280568
1434.000000, -13.243473
1435.000000, -13.206458
1436.000000, -13.169520
1437.000000, -13.132661
1438.000000, -13.095880
1439.000000, -13.059177
1440.000000, -13.022551
1441.000000, -12.986003
1442.000000, -12.949532
1443.000000, -12.913137
1444.000000, -12.876820
1445.000000, -12.840579
1446.000000, -12.804414
1447.000000, -12.768326
1448.000000, -12.732314
1449.000000, -12.696378
1450.000000, -12.660517
1451.000000, -12.624733
1452.000000, -12.589024
1453.000000, -12.553391
1454.000000, -12.517833
1455.000000, -12.482350
1456.000000, -12.446943
1457.000000, -12.411612
1458.000000, -12.376355
1459.000000, -12.341175
1460.000000, -12.306069
1461.000000, -12.271039
1462.000000, -12.236084
1463.000000, -12.201204
1464.000000, -12.166400
1465.000000, -12.131670
1466.000000, -12.097016
1467.000000, -12.062438
1468.000000, -12.027935
1469.000000, -11.993507
1470.000000, -11.959155
1471.000000, -11.924878
1472.000000, -11.890678
1473.000000, -11.856553
1474.000000, -11.822504
1475.000000, -11.788532
1476.000000, -11.754635
1477.000000, -11.720815
1478.000000, -11.687072
1479.000000, -11.653405
1480.000000, -11.619816
1481.000000, -11.586303
1482.000000, -11.552868
1483.000000, -11.519511
1484.000000, -11.486231
1485.000000, -11.453029
1486.000000, -11.419905
1487.000000, -11.386860
1488.000000, -11.353895
1489.000000, -11.321008
1490.000000, -11.288201
1491.000000, -11.255474
1492.000000, -11.222826
1493.000000, -11.190259
1494.000000, -11.157772
1495.000000, -11.125366
1496.000000, -11.093042
1497.000000, -11.060799
1498.000000, -11.028638
1499.000000, -10.996559
1500.000000, -10.964564
1501.000000, -10.932651
1502.000000, -10.900822
1503.000000, -10.869077
1504.000000, -10.837416
1505.000000, -10.805840
1506.000000, -10.774350
1507.000000, -10.742945
1508.000000, -10.711626
1509.000000, -10.680394
1510.000000, -10.649250
1511.000000, -10.618193
1512.000000, -10.587224
1513.000000, -10.556343
1514.000000, -10.525552
1515.000000, -10.494851
1516.000000, -10.464240
1517.000000, -10.433721
1518.000000, -10.403293
1519.000000, -10.372957
1520.000000, -10.342714
1521.000000, -10.312564
1522.000000, -10.282508
1523.000000, -10.252547
1524.000000, -10.222680
1525.000000, -10.192909
1526.000000, -10.163235
1527.000000, -10.133658
1528.000000, -10.104178
1529.000000, -10.074797
1530.000000, -10.045515
1531.000000, -10.016332
1532.000000, -9.987250
1533.000000, -9.958270
1534.000000, -9.929391
1535.000000, -9.900615
1536.000000, -9.871942
1537.000000, -9.843374
1538.000000, -9.814911
1539.000000, -9.786553
1540.000000, -9.758302
1541.000000, -9.730158
1542.000000, -9.702123
1543.000000, -9.674196
1544.000000, -9.646379
1545.000000, -9.618673
1546.000000, -9.591079
1547.000000, -9.563598
1548.000000, -9.536230
1549.000000, -9.508976
1550.000000, -9.481837
1551.000000, -9.454815
1552.000000, -9.427909
1553.000000, -9.401121
1554.000000, -9.374452
1555.000000, -9.347902
1556.000000, -9.321473
1557.000000, -9.295166
1558.000000, -9.268981
1559.000000, -9.242920
1560.000000, -9.216983
1561.000000, -9.191172
1562.000000, -9.165487
1563.000000, -9.139930
1564.000000, -9.114502
1565.000000, -9.089204
1566.000000, -9.064036
1567.000000, -9.039000
1568.000000, -9.014097
1569.000000, -8.989328
1570.000000, -8.964694
1571.000000, -8.940196
1572.000000, -8.915835
1573.000000, -8.891613
1574.000000, -8.867531
1575.000000, -8.843589
1576.000000, -8.819790
1577.000000, -8.796135
1578.000000, -8.772623
1579.000000, -8.749257
1580.000000, -8.726038
1581.000000, -8.702967
1582.000000, -8.680044
1583.000000, -8.657272
1584.000000, -8.634652
1585.000000, -8.612184
1586.000000, -8.589870
1587.000000, -8.567712
1588.000000, -8.545710
1589.000000, -8.523866
1590.000000, -8.502181
1591.000000, -8.480657
1592.000000, -8.459295
1593.000000, -8.438096
1594.000000, -8.417061
1595.000000, -8.396192
1596.000000, -8.375491
1597.000000, -8.354958
1598.000000, -8.334595
1599.000000, -8.314403




(*
; Define a normalized weight function for smoothing:
d:=10
defarray w[-d. +d]
calc
  begin
  var c;
  for x:=-d to +d do w[x]:=exp(-(2*x/d)^2);
  c:=sum(x:=-d to +d, w[x]);
  for x:=-d to +d do w[x]:=w[x]/c;
  end

defarray temp[l1_1500_Er.l2_1500_Er.dl_1500_Er]
calc  { smoothen the Er data beyond 1580 nm }
  begin
  var l1;
  l1:=l1_1500_Er+round(1580-l1_1500_Er)*dl_1500_Er;
  for l:=l1 to l2_1500_Er-d*dl_1500_Er step dl_1500_Er
  do temp[l]:=sum(x:=-d to +d*w[x]*s_a_Er_1500[l+x*dl_1500_Er]);
  for l:=l1 to l2_1500_Er-d*dl_1500_Er step dl_1500_Er
  do s_a_Er_1500[l]:=temp[l];
  for l:=l1 to l2_1500_Er-d*dl_1500_Er step dl_1500_Er
  do temp[l]:=sum(x:=-d to +d*w[x]*s_e_Er_1500[l+x*dl_1500_Er]);
  for l:=l1 to l2_1500_Er-d*dl_1500_Er step dl_1500_Er
  do s_e_Er_1500[l]:=temp[l];
  end
*)